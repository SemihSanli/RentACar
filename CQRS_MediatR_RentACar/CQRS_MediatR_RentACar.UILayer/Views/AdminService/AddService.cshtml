@model CreateServiceCommand
@{
    ViewData["Title"] = "AddService";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}


<div class="container-fluid px-4 py-4">
	<div class="d-flex justify-content-between align-items-center mb-3">
		<h1 class="h5 mb-0">Yeni Hizmet</h1>
		<a class="btn btn-outline-secondary" href="/AdminService/Index/">
			<i class="fas fa-arrow-left me-2"></i>Listeye Dön
		</a>
	</div>

	<div class="row">
		<div class="col-lg-8">
			<div class="card shadow-sm mb-4">
				<div class="card-body">
					<form asp-action="AddService" asp-controller="AdminService" method="post" novalidate>
						@Html.AntiForgeryToken()

						<div class="mb-3">
							<label class="form-label">Giriş Başlığı</label>
							<input asp-for="ServiceEntryTitle" class="form-control" placeholder="Örn. 7/24 Yol Yardım" required />
							<span class="text-danger" asp-validation-for="ServiceEntryTitle"></span>
						</div>

						<div class="row g-3">
							<div class="col-md-6">
								<label class="form-label">Makale Başlığı</label>
								<input asp-for="ServiceArticleTitle" class="form-control" placeholder="Örn. Acil Destek" required />
								<span class="text-danger" asp-validation-for="ServiceArticleTitle"></span>
							</div>
							<div class="col-md-6">
								<label class="form-label">İkon URL</label>
								<input asp-for="ServiceIconURL" id="iconUrl" class="form-control" placeholder="https://..." />
								<span class="text-danger" asp-validation-for="ServiceIconURL"></span>
							</div>
						</div>

						<div class="mt-3">
							<label class="form-label">Açıklama</label>
							<textarea asp-for="ServiceArticleDescription" class="form-control" rows="5" placeholder="Hizmet açıklamasını yazınız..." required></textarea>
							<span class="text-danger" asp-validation-for="ServiceArticleDescription"></span>
						</div>

						<hr class="my-4" />

						<div class="d-flex gap-2">
							<button type="submit" class="btn btn-primary">
								<i class="fas fa-save me-2"></i>Kaydet
							</button>
							<a href="/AdminService/Index/" class="btn btn-light">İptal</a>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!-- İkon Önizleme -->
		<div class="col-lg-4">
			<div class="card shadow-sm">
				<div class="card-header bg-white">
					<strong>İkon Önizleme</strong>
				</div>
				<div class="card-body">
					<div class="d-flex align-items-center gap-3">
						<div class="rounded-circle overflow-hidden border bg-light" style="width:72px;height:72px;">
							<img id="iconPreview" src="" alt="İkon" style="width:100%;height:100%;object-fit:cover;display:none;" />
						</div>
						<small id="iconPlaceholder" class="text-muted">Geçerli bir URL girildiğinde burada görünecek.</small>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

@section Scripts{
	<partial name="_ValidationScriptsPartial" />
	<script>
		(function(){
			const urlInput = document.getElementById('iconUrl');
			const img = document.getElementById('iconPreview');
			const ph = document.getElementById('iconPlaceholder');
			if(!urlInput) return;

			function update(){
				const v = (urlInput.value || '').trim();
				if(!v){ img.style.display='none'; ph.style.display='block'; img.removeAttribute('src'); return; }
				img.src = v;
				img.onload = () => { img.style.display='block'; ph.style.display='none'; };
				img.onerror = () => { img.style.display='none'; ph.style.display='block'; };
			}
			urlInput.addEventListener('input', update);
			update();
		})();
	</script>
}

